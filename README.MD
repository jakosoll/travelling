# Сайт по поиску маршрута по заданным параметрам.
## Задание:
Поиск маршрута перемещения из одной точки в другую. Задача делится на 3 части - населенные пункты, поезда, маршруты.

### Населенные пункты.
Реализовать добавление, редактирование, удаление населенного пункта, а также постраничный просмотр всех доступных населенных пунктов. У населенного пункта есть лишь название

### Поезда.
Реализовать добавление, редактирование, удаление поезда, а также постраничный просмотр всех доступных поездов. У поезда есть уникальный код (название), начало маршрута, конец маршрута и время в пути в условных единицах. Из одной точки в другую может быть несколько поездов, но они должны отличаться по времени в пути.

### Маршруты.
Пользователь выбирает начальный и конечный пункт маршрута, а также указывает максимальное время в пути. Также пользователь может добавить сколь угодно промежуточных городов, через которые должен пролегать маршрут. Ему загружаются подходящие под условия маршруты. Возле каждого маршрута должна быть кнопка, позволяющая сохранить данный маршрут, задав ему имя. При поиске маршрутов, необходимо обращать внимание на направление движения поезда.

### Вывод результатов.
Вывод маршрутов сортируется по наименьшему времени в пути. Т.е. первым отображается маршрут, с наименьшим временем в пути. Описание маршрута должно содержать информацию о том, откуда и куда ведет этот маршрут, время в пути, а также содержать список всех поездов, которые есть в этом маршруте с указанием номера поезда, откуда\куда и времени в пути.
В случае, если маршрут не найден, вывести сообщение - "Маршрута удовлетворяющего условиям поиска не существует " Если же, заданное время в пути меньше, чем минимальное время маршрута, тогда сообщение "Время в дороге больше выбранного Вами. Измените время."

### Сохраненные маршруты.
Реализована отдельная страница с просмотром маршрутов. Маршрут можно только сохранить, посмотреть и удалить. Редактировать сохраненный маршрут нельзя.

### Тесты.
Должны покрывать 40% кода.

### Доступ к сайту.
Доступ к добавлению\редактированию Поездов\Городов, а также удалению любых записей, должен быть только у зарегистрированных пользователей.

## Небольшие изменения в коде, которые я посчитал правильным исправить
По логике приложения после поиска маршруты не сохраняются в базу данных, а отображаются пользователю, который может сохранить любой из них. Автор реализовал обмен данными через скрытые формы. Из-за этого одинаковый код дублируется в контроллерах при работе с формами: сперва отобразить маршрут, потом передать его в форму при GET-запросе, и получить эту форму в POST-запросе. Я посчитал это перегруженным и излишним.

Я релизовал данный механизм проще - с помощью класса `Route`, который работает с сессией. Сохраняет список найденных маршрутов, с указанием id каждого маршрута, определеяет метод `__iter__` и метод `get_route()` с помощью которых можно получить экземпляры моделей из БД и работать с ними в templates. Основной код совержится в файле `apps/routes/route.py`

Так же я перенес код, который обрабатывает и проверяет данные формы из `view` в `forms`, что позволило сделать код view более лаконичным  

Еще одно изменение коснулось порядка поездов в маршруте. По формировании запроса из БД, поезда добавлялись в случайном порядке. Реализовал их порядок при помощи утилит Django `Case` и `When`. Написал тест, который проверяет порядок поездов в маршруте.
